## Clone my repo

Clone my [repo](git@gitlab.com:safalta-tech/recommendation-2.0.git)


```bash
$ git clone git@gitlab.com:safalta-tech/recommendation-2.0.git && cd recommendation-2.0
```

Then you can start `server` with the following command

<div class="termy">

```console
$ python3 API/app.py
2022-05-18 14:36:03,035 - INFO - werkzeug :: _internal ::  _log  |  225  ::   * Running on http://127.0.0.1:5004/

```

</div>




## Project layout


* Data
    * Interim:  This data would be the data that we would load for feature engineering by using a script in the src/data
      directory. This dataset is generated by performing various joins and/or merges to combine the external and raw
      data.
    * Processed: This is the data that has been transformed. It serves as a good idea to persist the processed data in
      order to shorten the training time of our model.
    * Raw: Having a local subset copy of data ensures that you have a static dataset to perform task on. Additionally,
      this overcomes any workflow breakdowns due to network latency issues.


* Models:   
  We use a script in src\models for training of our Machine Learning model. In order to do this we save the trained
  model to a file and that file would be saved in this directory.

* src
    * Models: Contains scripts that are used to build and train our model.
        * `safalta_courses_recommendations_beta.py` : For safalta courses recommendations.
        * `safalta_course_rec_mock_test.py`: Recommends courses or mock test related to mock test or user.

* Flask-app
    * `app.py`: App uses trained model to serve recommendations

## Process

* For courses related recommendation section:
    * < Daily > First `fetch_sf_data_bigquery.py` will fetch data buy_now, pay_now and event_views data from bigquery
    * < Daily > Then, `safalta_course_recommendations_beta.py` will merge those, preprocess and fit on same data.

    * Related API consumption functions through app.py:
        * `get_course_recommendation` : Returns similar course slugs from a course_slug
        * `get_multiple_courses_recommendation`:  Returns lists of similar course slugs from multiple course slugs
        * `get_free_course_recommendation`: Returns only free course slugs from a course slug
        * `get_free_multiple_course_recommendation`: Returns only lists of free course slugs from a course slug
        * `get_user_recommendation`: Returns courses from a safalta user_id based on C.F.


* For mock test related recommendation section [To be deployed] :
    * < Daily > First `fetch_sf_mocktest.py` will fetch data `mock test` and safalta event views data from bigquery
    * < Daily > Then, `safalta_course_rec_mock_test.py` will merge `mock_test` and `event_views`, preprocess and fit on
      same data.

    * Related API consumption functions through app.py:
        * `get_mock_test_recommendation`: Returns similar mock test names from a mock test name
        * `get_course_recommendation_from_mock_test`: Returns related courses from a mock test name
        * `get_mock_test_user_course_recommendation`:  Returns courses from a safalta user_id, course_type(free/paid)
          based on C.F.
        * `get_multiple_mock_test_recommendation`:  Returns lists of similar mock test title names from multiple mock test
          names
        * `get_mock_test_or_course_recommendation_from_mock_test`: Returns related courses or mock test based on
          conditions from a mock test name, sf_user_id, score, course_type.
